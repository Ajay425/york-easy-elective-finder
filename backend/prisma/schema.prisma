// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


// model Course {
//   id        Int      @id @default(autoincrement()) 
//   deptAcronym   String 
//   dept      Department @relation(fields:[deptAcronym], references: [acronym])
//   code      String
//   credit    Float?
//   name      String
//   prerequisites     Course[] @relation("CourseToPrereqs")
//   prerequisiteFor   Course[] @relation("CourseToPrereqs")
//   desc      String?
// }

model Course {
  id        Int      @id @default(autoincrement()) 
  faculty   String
  deptAcronym   String 
  courseCode      String
  credit    Float
  name      String?
  desc      String?
  language String?
  year Int

  courseOfferings CurrentCourseOfferings[]
  prerequisites     CoursePrerequisite[] @relation("CoursePrerequisite_course")
  prerequisiteFor   CoursePrerequisite[] @relation("CoursePrerequisite_prereq")
  @@unique([faculty, deptAcronym,courseCode, credit])
}

model CoursePrerequisite {
  id           Int      @id @default(autoincrement())
  courseId     Int
  prereqId     Int
  course       Course   @relation("CoursePrerequisite_course", fields: [courseId], references: [id])
  prerequisite Course   @relation("CoursePrerequisite_prereq", fields: [prereqId], references: [id])
  @@unique([courseId, prereqId])
}

// //Faculty houses Department
model Faculty{
  acronym String @id @unique
  longForm String
  url String 
}

model Department{
  acronym String @id @unique
  longForm String? 
}


model Instructors{
  id Int @id @default(autoincrement()) 
  firstname String
  lastname String
  avgRating Float?
  avgDifficulty Float?
  wouldTakeAgainPercent Float?
  numberOfRatings Int?
  department String?
  rateMyProfLink String?
  offerings InstructorOfferings[]
  @@unique([firstname, lastname])
  @@map("Professor")  //  tells Prisma this model uses the existing "Professors" table
}

model CurrentCourseOfferings{
  id Int @id @default(autoincrement())
  term String
  courseId Int
  course Course @relation(fields:[courseId], references: [id])
  section String
  type String
  instructors InstructorOfferings[]
  @@unique([term,courseId, section, type])
}

model InstructorOfferings{
  id Int @id @default(autoincrement())
  instructorId Int
  courseOfferingId Int
  instructor Instructors @relation(fields:[instructorId], references:[id])
  courseOffering CurrentCourseOfferings @relation(fields:[courseOfferingId], references:[id])
@@unique([instructorId, courseOfferingId])
}

// model Department{
//   acronym String @id @unique
//   longForm String 
//   courses Course[]
//   facultyAcronym String
//   faculty        Faculty     @relation(fields: [facultyAcronym], references: [acronym])
// }


// //Faculty houses Department
// model Faculty{
//   acronym String @id @unique
//   longForm String
//   deptAcronym String 
//   department Department[]
// }

// model 
// model Professor{
//   id Int @id @unique
//   department String
//   firstname String
//   lastname String
//   numRatings Float?
//   overallRating String?
// }


// model courseAvailablity{
//   courseCode String
//   term String
//   section String
//   lecturetype String
//   professor String
// }
